import{j as e,L as j,b as c,V as l,q}from"./index-BSR7YrIA.js";import{u as o}from"./useQuery-Bls-ed2C.js";import{u as y}from"./useMutation-CIE9l-8x.js";import{W as R}from"./Wrapper-Cm4OHuQf.js";import{CardLoader as u}from"./Loader-BR6Ae3rj.js";import{s as N,b as v,c as w,d as F}from"./Api-9Y_Rk4KA.js";import{U as b}from"./UserCard-B_TIlJg3.js";function E({...i}){const r=i;return e.jsxs("div",{className:"card p-2 card-rounded shadow",style:{maxWidth:"400px",flex:"1 1 400px"},children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between gap-3",children:e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("img",{src:r.profilePic,alt:"Profile",width:50,height:50,style:{borderRadius:"50%"}}),e.jsx("div",{className:"card-header p-0 border-0 bg-white",children:r.fullName})]})}),e.jsxs("div",{className:"card-body p-1 py-2",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("p",{className:"card-text",children:["Native: -",r.nativeLanguage]}),e.jsxs("p",{className:"card-text",children:["Learning: -",r.learningLanguage]})]}),e.jsx(j,{to:`/chat/${r?._id}`,className:"btn btn-primary w-100",children:"Message"})]})]},r._id)}function M(){const[i,r]=c.useState(new Set),{data:t=[],isPending:g,isError:m}=o({queryKey:["friends"],queryFn:v}),{data:a=[],isPending:x,isError:h}=o({queryKey:["recommendedUser"],queryFn:w}),{data:n,isPending:S,isError:I}=o({queryKey:["outgoingRequests"],queryFn:F}),{mutate:p=[]}=y({mutationFn:N,onSuccess:s=>{q.invalidateQueries({queryKey:["outgoingRequests"]}),l.success(s?.response?.data?.message||"Friend Request Sent")},onError:s=>{console.error("Error sending request:",s),l.error(s?.response?.data?.message)}});function f(s){p(s)}return c.useEffect(()=>{const s=new Set;n?.outgoingRequest&&n?.outgoingRequest.length>0&&(n?.outgoingRequest.forEach(d=>{s.add(d?.recipient)}),r(s))},[n]),e.jsx(R,{pageTitle:"Dashboard",children:e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{className:"",children:[e.jsx("h5",{className:"display-6",children:"Recent Friends"}),g&&e.jsx(u,{}),m&&e.jsx("div",{children:"Something went wrong."}),(!t||t.length===0)&&"There is no friend yet",e.jsx("div",{className:"d-flex flex-wrap gap-3",children:t.map(s=>e.jsx(E,{...s},s._id))})]}),e.jsxs("div",{className:"",children:[e.jsx("h5",{className:"display-6",children:"Make Recommended users as a Friends"}),x&&e.jsx(u,{}),h&&e.jsx("div",{children:"Something went wrong."}),(!a||a.length===0)&&"No Friend",e.jsx("div",{className:"d-flex flex-wrap gap-3",children:a.map(s=>{const d=i.has(s._id);return e.jsx(b,{onSendRequest:f,...s,isSent:d},s._id)})})]})]})})}export{M as default};
